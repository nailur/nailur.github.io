<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Indonesia Gold Price Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:system-ui;background:#0d1117;color:#e6edf3;margin:0;padding:20px}
h2{margin-bottom:6px}
.card{background:#161b22;border-radius:14px;padding:16px;margin-bottom:12px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;text-align:left}
th{color:#8b949e;font-size:13px}
tr:hover{background:#21262d}
.good{color:#3fb950;font-weight:bold}
.bad{color:#f85149}
small{color:#8b949e}
</style>
</head>
<body>

<h2>Live Indonesia Gold Prices</h2>
<small>Source: nailur.vercel.app/api/harga-emas</small>

<div id="app"></div>

<script>
const API = "https://nailur.vercel.app/api/harga-emas";

async function load(){
  const res = await fetch(API);
  const json = await res.json();
  const rows = json.data.filter(r=>r.gram==="1");

  const grouped = {};
  rows.forEach(r=>{
    if(!grouped[r.category]) grouped[r.category]=[];
    grouped[r.category].push(parseInt(r.jual));
  });

  const brands = Object.keys(grouped).map(k=>{
    const avg = Math.min(...grouped[k]);
    return {brand:k, price:avg};
  }).sort((a,b)=>a.price-b.price);

  let html="";
  brands.forEach((b,i)=>{
    html+=`
      <div class="card">
        <h3>${b.brand} ${i===0?'<span class="good">(CHEAPEST)</span>':''}</h3>
        <table>
          <tr><th>1 Gram Price</th><td class="${i===0?'good':'bad'}">Rp ${b.price.toLocaleString("id-ID")}</td></tr>
        </table>
      </div>
    `;
  });

  document.getElementById("app").innerHTML = html;
}

load();
setInterval(load, 600000); // refresh every 10 min
</script>

</body>
</html>
