<h2>Galeri24</h2>
<pre id="galeri24">Loading...</pre>

<h2>Sampoerna Gold</h2>
<pre id="sampoerna">Loading...</pre>

<script>
const CORS_PROXY = "https://api.allorigins.win/raw?url=";

async function fetchHTML(url) {
	const res = await fetch(CORS_PROXY + encodeURIComponent(url));
	return res.text();
}

function parseGaleri24(doc) {
	const result = [];

	const list = ["GALERI 24","ANTAM","ANTAM MULIA RETRO","ANTAM NON PEGADAIAN","UBS","LOTUS ARCHI"];


	for (const item in list) {
		const container = doc.getElementById(item).children[0].children[2];

		container.forEach(el => {
			const text = el.innerText;

			const gram =
				text.match(/(\d+(?:[.,]\d+)?)\s*gram/i)?.[1];

			const prices =
				text.match(/Rp[\s\d.]+/g) || [];

			if (!gram || prices.length < 2) return;

			result.push({
				category,
				gram: gram.replace(",", "."),
				jual: prices[0],
				buyback: prices[1]
			});
		});
	}

	return result
}

async function loadGaleri24() {
	const html = await fetchHTML("https://galeri24.co.id/harga-emas");
	const doc = new DOMParser().parseFromString(html, "text/html");
	const data = parseGaleri24(doc);
	
	document.getElementById("galeri24").textContent =
	JSON.stringify(data, null, 2);
}

function parseTable(doc) {
	const data = [];
	doc.querySelectorAll("table tr").forEach(row => {
	const cols = row.querySelectorAll("td");
	if (cols.length >= 3) {
		data.push({
		gram: cols[0].innerText.trim(),
		jual: cols[1].innerText.trim(),
		buyback: cols[2].innerText.trim()
		});
	}
	});
	return data;
}


async function loadSampoerna() {
	const html = await fetchHTML("https://sampoernagold.com/");
	const doc = new DOMParser().parseFromString(html, "text/html");
	const data = parseTable(doc);

	document.getElementById("sampoerna").textContent =
	JSON.stringify(data, null, 2);
}

loadGaleri24();
loadSampoerna();
</script>